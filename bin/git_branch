#!/usr/bin/env ruby

RED="\033[0;31m"
YELLOW="\033[0;33m"
GREEN="\033[0;32m"
NO_COLOR="\033[0m"

def red s
  "#{RED}#{s}#{NO_COLOR}"
end

def green s
  "#{GREEN}#{s}#{NO_COLOR}"
end

def yellow s
  "#{YELLOW}#{s}#{NO_COLOR}"
end

def branch
  `git branch`.lines.select {|line| /^\*/ =~ line }.first.sub(/^\* /,"").chomp
end

def apply_status branch
  status = `git status --porcelain`
  return red "<#{branch}>" if /^ ([MARCD])/ =~ status
  return yellow "{#{branch}}" if /^([MARCD]) / =~ status
  return green "(#{branch})"
end

puts apply_status branch